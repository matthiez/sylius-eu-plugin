{% macro price(gross, contents, contentsUnit) %}
    {{ (gross * (contentsUnit == "mg" ? 10000 : 10) / contents)|round(2)|number_format(2, ',', '.') }}
{% endmacro %}

{% macro html(product, _contentsUnit, _contents, units, pdp) %}
    {% import _self as macros %}

    {% set contentsUnit = product.getAttributeByCodeAndLocale(_contentsUnit, sylius.localeCode) %}

    {% if contentsUnit is not null %}
        {% set unit = contentsUnit.attribute.configuration.choices[contentsUnit.value[0]][sylius.localeCode] %}

        {% if unit is not null and unit in units %}
            {% set contents = product.getAttributeByCodeAndLocale(_contents, sylius.localeCode) %}

            {% if contents is defined and contents.value is not same as(0) %}
                {% import '@EcolosSyliusEuPlugin/from.html.twig' as from %}

                <span id='ecolos-eu-product-base-price'>
                    {% if pdp != true %} {{ from.variants(product) }} {% endif %}
                    {{ macros.price(product|sylius_resolve_variant|sylius_calculate_price({'channel': sylius.channel}), contents.value, unit) }}
                    â‚¬ /{{ macros.transformUnit(unit) }}
                </span>
            {% endif %}
        {% endif %}
    {% endif %}
{% endmacro %}

{% macro transformUnit(contentsUnit) %}
    {% if contentsUnit == 'ml' %} {{ 'l' }}
    {% elseif contentsUnit == 'mg' %} {{ 'kg' }}
    {% else %} {{ 'kg' }}
    {% endif %}
{% endmacro %}
